{"ast":null,"code":"import { vModelText as _vModelText, withModifiers as _withModifiers, withKeys as _withKeys, mergeProps as _mergeProps, createElementVNode as _createElementVNode, withDirectives as _withDirectives, renderSlot as _renderSlot, openBlock as _openBlock, createElementBlock as _createElementBlock, createCommentVNode as _createCommentVNode, renderList as _renderList, Fragment as _Fragment, normalizeClass as _normalizeClass, pushScopeId as _pushScopeId, popScopeId as _popScopeId } from \"vue\";\nvar _withScopeId = function _withScopeId(n) {\n  return _pushScopeId(\"data-v-402c342f\"), n = n(), _popScopeId(), n;\n};\nvar _hoisted_1 = [\"id\"];\nvar _hoisted_2 = [\"id\", \"placeholder\"];\nvar _hoisted_3 = {\n  key: 0,\n  \"class\": \"simple-typeahead-list\"\n};\nvar _hoisted_4 = {\n  key: 0,\n  \"class\": \"simple-typeahead-list-header\"\n};\nvar _hoisted_5 = [\"onClick\", \"onMouseenter\"];\nvar _hoisted_6 = [\"data-text\"];\nvar _hoisted_7 = [\"data-text\", \"innerHTML\"];\nvar _hoisted_8 = {\n  key: 1,\n  \"class\": \"simple-typeahead-list-footer\"\n};\nexport function render(_ctx, _cache, $props, $setup, $data, $options) {\n  return _openBlock(), _createElementBlock(\"div\", {\n    id: _ctx.wrapperId,\n    \"class\": \"simple-typeahead\"\n  }, [_withDirectives(_createElementVNode(\"input\", _mergeProps({\n    ref: \"inputRef\",\n    id: _ctx.inputId,\n    \"class\": \"simple-typeahead-input\",\n    type: \"text\",\n    placeholder: _ctx.placeholder,\n    \"onUpdate:modelValue\": _cache[0] || (_cache[0] = function ($event) {\n      return _ctx.input = $event;\n    }),\n    onInput: _cache[1] || (_cache[1] = function () {\n      return _ctx.onInput && _ctx.onInput.apply(_ctx, arguments);\n    }),\n    onFocus: _cache[2] || (_cache[2] = function () {\n      return _ctx.onFocus && _ctx.onFocus.apply(_ctx, arguments);\n    }),\n    onBlur: _cache[3] || (_cache[3] = function () {\n      return _ctx.onBlur && _ctx.onBlur.apply(_ctx, arguments);\n    }),\n    onKeydown: [_cache[4] || (_cache[4] = _withKeys(_withModifiers(function () {\n      return _ctx.onArrowDown && _ctx.onArrowDown.apply(_ctx, arguments);\n    }, [\"prevent\"]), [\"down\"])), _cache[5] || (_cache[5] = _withKeys(_withModifiers(function () {\n      return _ctx.onArrowUp && _ctx.onArrowUp.apply(_ctx, arguments);\n    }, [\"prevent\"]), [\"up\"])), _cache[6] || (_cache[6] = _withKeys(_withModifiers(function () {\n      return _ctx.selectCurrentSelection && _ctx.selectCurrentSelection.apply(_ctx, arguments);\n    }, [\"prevent\"]), [\"enter\"])), _cache[7] || (_cache[7] = _withKeys(_withModifiers(function () {\n      return _ctx.selectCurrentSelectionTab && _ctx.selectCurrentSelectionTab.apply(_ctx, arguments);\n    }, [\"prevent\"]), [\"tab\"]))],\n    autocomplete: \"off\"\n  }, _ctx.$attrs), null, 16 /* FULL_PROPS */, _hoisted_2), [[_vModelText, _ctx.input]]), _ctx.isListVisible ? (_openBlock(), _createElementBlock(\"div\", _hoisted_3, [_ctx.$slots['list-header'] ? (_openBlock(), _createElementBlock(\"div\", _hoisted_4, [_renderSlot(_ctx.$slots, \"list-header\", {}, undefined, true)])) : _createCommentVNode(\"v-if\", true), (_openBlock(true), _createElementBlock(_Fragment, null, _renderList(_ctx.filteredItems, function (item, index) {\n    return _openBlock(), _createElementBlock(\"div\", {\n      \"class\": _normalizeClass([\"simple-typeahead-list-item\", {\n        'simple-typeahead-list-item-active': _ctx.currentSelectionIndex == index\n      }]),\n      key: index,\n      onMousedown: _cache[8] || (_cache[8] = _withModifiers(function () {}, [\"prevent\"])),\n      onClick: function onClick($event) {\n        return _ctx.selectItem(item);\n      },\n      onMouseenter: function onMouseenter($event) {\n        return _ctx.currentSelectionIndex = index;\n      }\n    }, [_ctx.$slots['list-item-text'] ? (_openBlock(), _createElementBlock(\"span\", {\n      key: 0,\n      \"class\": \"simple-typeahead-list-item-text\",\n      \"data-text\": _ctx.itemProjection(item)\n    }, [_renderSlot(_ctx.$slots, \"list-item-text\", {\n      item: item,\n      itemProjection: _ctx.itemProjection,\n      boldMatchText: _ctx.boldMatchText\n    }, undefined, true)], 8 /* PROPS */, _hoisted_6)) : (_openBlock(), _createElementBlock(\"span\", {\n      key: 1,\n      \"class\": \"simple-typeahead-list-item-text\",\n      \"data-text\": _ctx.itemProjection(item),\n      innerHTML: _ctx.boldMatchText(_ctx.itemProjection(item))\n    }, null, 8 /* PROPS */, _hoisted_7))], 42 /* CLASS, PROPS, HYDRATE_EVENTS */, _hoisted_5);\n  }), 128 /* KEYED_FRAGMENT */)), _ctx.$slots['list-footer'] ? (_openBlock(), _createElementBlock(\"div\", _hoisted_8, [_renderSlot(_ctx.$slots, \"list-footer\", {}, undefined, true)])) : _createCommentVNode(\"v-if\", true)])) : _createCommentVNode(\"v-if\", true)], 8 /* PROPS */, _hoisted_1);\n}","map":{"version":3,"names":["_createElementBlock","id","_ctx","wrapperId","_createElementVNode","_mergeProps","ref","inputId","type","placeholder","input","$event","onInput","_cache","apply","arguments","onFocus","onBlur","onKeydown","onArrowDown","onArrowUp","selectCurrentSelection","selectCurrentSelectionTab","autocomplete","$attrs","_hoisted_2","isListVisible","_hoisted_3","$slots","_hoisted_4","_renderSlot","undefined","_Fragment","_renderList","filteredItems","item","index","_normalizeClass","currentSelectionIndex","key","onMousedown","_withModifiers","onClick","selectItem","onMouseenter","itemProjection","boldMatchText","innerHTML","_hoisted_8"],"sources":["/Users/venegrad/Projects/@venegrad/autocomplete/src/ven-autocomplete.vue"],"sourcesContent":["<template>\n\t<div :id=\"wrapperId\" class=\"simple-typeahead\">\n\t\t<input\n\t\t\tref=\"inputRef\"\n\t\t\t:id=\"inputId\"\n\t\t\tclass=\"simple-typeahead-input\"\n\t\t\ttype=\"text\"\n\t\t\t:placeholder=\"placeholder\"\n\t\t\tv-model=\"input\"\n\t\t\t@input=\"onInput\"\n\t\t\t@focus=\"onFocus\"\n\t\t\t@blur=\"onBlur\"\n\t\t\t@keydown.down.prevent=\"onArrowDown\"\n\t\t\t@keydown.up.prevent=\"onArrowUp\"\n\t\t\t@keydown.enter.prevent=\"selectCurrentSelection\"\n\t\t\t@keydown.tab.prevent=\"selectCurrentSelectionTab\"\n\t\t\tautocomplete=\"off\"\n\t\t\tv-bind=\"$attrs\"\n\t\t/>\n\t\t<div v-if=\"isListVisible\" class=\"simple-typeahead-list\">\n\t\t\t<div class=\"simple-typeahead-list-header\" v-if=\"$slots['list-header']\"><slot name=\"list-header\"></slot></div>\n\t\t\t<div\n\t\t\t\tclass=\"simple-typeahead-list-item\"\n\t\t\t\t:class=\"{ 'simple-typeahead-list-item-active': currentSelectionIndex == index }\"\n\t\t\t\tv-for=\"(item, index) in filteredItems\"\n\t\t\t\t:key=\"index\"\n\t\t\t\t@mousedown.prevent\n\t\t\t\t@click=\"selectItem(item)\"\n\t\t\t\t@mouseenter=\"currentSelectionIndex = index\"\n\t\t\t>\n\t\t\t\t<span class=\"simple-typeahead-list-item-text\" :data-text=\"itemProjection(item)\" v-if=\"$slots['list-item-text']\"\n\t\t\t\t\t><slot name=\"list-item-text\" :item=\"item\" :itemProjection=\"itemProjection\" :boldMatchText=\"boldMatchText\"></slot\n\t\t\t\t></span>\n\t\t\t\t<span class=\"simple-typeahead-list-item-text\" :data-text=\"itemProjection(item)\" v-html=\"boldMatchText(itemProjection(item))\" v-else></span>\n\t\t\t</div>\n\t\t\t<div class=\"simple-typeahead-list-footer\" v-if=\"$slots['list-footer']\"><slot name=\"list-footer\"></slot></div>\n\t\t</div>\n\t</div>\n</template>\n\n<script>\n\timport { defineComponent } from 'vue';\n\n\texport default /*#__PURE__*/ defineComponent({\n\t\tname: 'autocomplete',\n\t\temits: ['onInput', 'onFocus', 'onBlur', 'selectItem'],\n\t\tinheritAttrs: false,\n\t\tprops: {\n\t\t\tid: {\n\t\t\t\ttype: String,\n\t\t\t},\n\t\t\tplaceholder: {\n\t\t\t\ttype: String,\n\t\t\t\tdefault: '',\n\t\t\t},\n\t\t\titems: {\n\t\t\t\ttype: Array,\n\t\t\t\trequired: true,\n\t\t\t},\n\t\t\tdefaultItem: {\n\t\t\t\tdefault: null,\n\t\t\t},\n\t\t\titemProjection: {\n\t\t\t\ttype: Function,\n\t\t\t\tdefault(item) {\n\t\t\t\t\treturn item;\n\t\t\t\t},\n\t\t\t},\n\t\t\tminInputLength: {\n\t\t\t\ttype: Number,\n\t\t\t\tdefault: 2,\n\t\t\t\tvalidator: (prop) => {\n\t\t\t\t\treturn prop >= 0;\n\t\t\t\t},\n\t\t\t},\n\t\t\tminItemLength: {\n\t\t\t\ttype: Number,\n\t\t\t\tdefault: 0,\n\t\t\t\tvalidator: (prop) => {\n\t\t\t\t\treturn prop >= 0;\n\t\t\t\t},\n\t\t\t},\n\t\t\tselectOnTab: {\n\t\t\t\ttype: Boolean,\n\t\t\t\tdefault: true,\n\t\t\t},\n\t\t},\n\t\tmounted() {\n\t\t\tif (this.defaultItem !== undefined && this.defaultItem !== null) {\n\t\t\t\tthis.selectItem(this.defaultItem);\n\t\t\t}\n\t\t},\n\t\tdata() {\n\t\t\treturn {\n\t\t\t\tinputId: this.id || `simple_typeahead_${(Math.random() * 1000).toFixed()}`,\n\t\t\t\tinput: '',\n\t\t\t\tisInputFocused: false,\n\t\t\t\tcurrentSelectionIndex: 0,\n\t\t\t};\n\t\t},\n\t\tmethods: {\n\t\t\tonInput() {\n\t\t\t\tif (this.isListVisible && this.currentSelectionIndex >= this.filteredItems.length) {\n\t\t\t\t\tthis.currentSelectionIndex = (this.filteredItems.length || 1) - 1;\n\t\t\t\t}\n\t\t\t\tthis.$emit('onInput', { input: this.input, items: this.filteredItems });\n\t\t\t},\n\t\t\tonFocus() {\n\t\t\t\tthis.isInputFocused = true;\n\t\t\t\tthis.$emit('onFocus', { input: this.input, items: this.filteredItems });\n\t\t\t},\n\t\t\tonBlur() {\n\t\t\t\tthis.isInputFocused = false;\n\t\t\t\tthis.$emit('onBlur', { input: this.input, items: this.filteredItems });\n\t\t\t},\n\t\t\tonArrowDown($event) {\n\t\t\t\tif (this.isListVisible && this.currentSelectionIndex < this.filteredItems.length - 1) {\n\t\t\t\t\tthis.currentSelectionIndex++;\n\t\t\t\t}\n\t\t\t\tthis.scrollSelectionIntoView();\n\t\t\t},\n\t\t\tonArrowUp($event) {\n\t\t\t\tif (this.isListVisible && this.currentSelectionIndex > 0) {\n\t\t\t\t\tthis.currentSelectionIndex--;\n\t\t\t\t}\n\t\t\t\tthis.scrollSelectionIntoView();\n\t\t\t},\n\t\t\tscrollSelectionIntoView() {\n\t\t\t\tsetTimeout(() => {\n\t\t\t\t\tconst list_node = document.querySelector(`#${this.wrapperId} .simple-typeahead-list`);\n\t\t\t\t\tconst active_node = document.querySelector(`#${this.wrapperId} .simple-typeahead-list-item.simple-typeahead-list-item-active`);\n\n\t\t\t\t\tif (!(active_node.offsetTop >= list_node.scrollTop && active_node.offsetTop + active_node.offsetHeight < list_node.scrollTop + list_node.offsetHeight)) {\n\t\t\t\t\t\tlet scroll_to = 0;\n\t\t\t\t\t\tif (active_node.offsetTop > list_node.scrollTop) {\n\t\t\t\t\t\t\tscroll_to = active_node.offsetTop + active_node.offsetHeight - list_node.offsetHeight;\n\t\t\t\t\t\t} else if (active_node.offsetTop < list_node.scrollTop) {\n\t\t\t\t\t\t\tscroll_to = active_node.offsetTop;\n\t\t\t\t\t\t}\n\n\t\t\t\t\t\tlist_node.scrollTo(0, scroll_to);\n\t\t\t\t\t}\n\t\t\t\t});\n\t\t\t},\n\t\t\tselectCurrentSelection() {\n\t\t\t\tif (this.currentSelection) {\n\t\t\t\t\tthis.selectItem(this.currentSelection);\n\t\t\t\t}\n\t\t\t},\n\t\t\tselectCurrentSelectionTab() {\n\t\t\t\tif (this.selectOnTab) {\n\t\t\t\t\tthis.selectCurrentSelection();\n\t\t\t\t} else {\n\t\t\t\t\tthis.$refs.inputRef.blur();\n\t\t\t\t}\n\t\t\t},\n\t\t\tselectItem(item) {\n\t\t\t\tthis.input = this.itemProjection(item);\n\t\t\t\tthis.currentSelectionIndex = 0;\n\t\t\t\tthis.$refs.inputRef.blur();\n\t\t\t\tthis.$emit('selectItem', item);\n\t\t\t},\n\t\t\tescapeRegExp(string) {\n\t\t\t\treturn string.replace(/[.*+?^${}()|[\\]\\\\]/g, '\\\\$&');\n\t\t\t},\n\t\t\tboldMatchText(text) {\n\t\t\t\tconst regexp = new RegExp(`(${this.escapeRegExp(this.input)})`, 'ig');\n\t\t\t\treturn text.replace(regexp, '<strong>$1</strong>');\n\t\t\t},\n\t\t\tclearInput() {\n\t\t\t\tthis.input = '';\n\t\t\t},\n\t\t\tgetInput() {\n\t\t\t\treturn this.$refs.inputRef;\n\t\t\t},\n\t\t\tfocusInput() {\n\t\t\t\tthis.$refs.inputRef.focus();\n\t\t\t\tthis.onFocus();\n\t\t\t},\n\t\t\tblurInput() {\n\t\t\t\tthis.$refs.inputRef.blur();\n\t\t\t\tthis.onBlur();\n\t\t\t},\n\t\t},\n\t\tcomputed: {\n\t\t\twrapperId() {\n\t\t\t\treturn `${this.inputId}_wrapper`;\n\t\t\t},\n\t\t\tfilteredItems() {\n\t\t\t\tconst regexp = new RegExp(this.escapeRegExp(this.input), 'i');\n\n\t\t\t\treturn this.items.filter((item) => this.itemProjection(item).match(regexp));\n\t\t\t},\n\t\t\tisListVisible() {\n\t\t\t\treturn this.isInputFocused && this.input.length >= this.minInputLength && this.filteredItems.length > this.minItemLength;\n\t\t\t},\n\t\t\tcurrentSelection() {\n\t\t\t\treturn this.isListVisible && this.currentSelectionIndex < this.filteredItems.length ? this.filteredItems[this.currentSelectionIndex] : undefined;\n\t\t\t},\n\t\t},\n\t});\n</script>\n\n<style scoped>\n\t.simple-typeahead {\n\t\tposition: relative;\n\t\twidth: 100%;\n\t}\n\t.simple-typeahead > input {\n\t\tmargin-bottom: 0;\n\t}\n\t.simple-typeahead .simple-typeahead-list {\n\t\tposition: absolute;\n\t\twidth: 100%;\n\t\tborder: none;\n\t\tmax-height: 400px;\n\t\toverflow-y: auto;\n\t\tborder-bottom: 0.1rem solid #d1d1d1;\n\t\tz-index: 9;\n\t}\n\t.simple-typeahead .simple-typeahead-list .simple-typeahead-list-header {\n\t\tbackground-color: #fafafa;\n\t\tpadding: 0.6rem 1rem;\n\t\tborder-bottom: 0.1rem solid #d1d1d1;\n\t\tborder-left: 0.1rem solid #d1d1d1;\n\t\tborder-right: 0.1rem solid #d1d1d1;\n\t}\n\t.simple-typeahead .simple-typeahead-list .simple-typeahead-list-footer {\n\t\tbackground-color: #fafafa;\n\t\tpadding: 0.6rem 1rem;\n\t\tborder-left: 0.1rem solid #d1d1d1;\n\t\tborder-right: 0.1rem solid #d1d1d1;\n\t}\n\t.simple-typeahead .simple-typeahead-list .simple-typeahead-list-item {\n\t\tcursor: pointer;\n\t\tbackground-color: #fafafa;\n\t\tpadding: 0.6rem 1rem;\n\t\tborder-bottom: 0.1rem solid #d1d1d1;\n\t\tborder-left: 0.1rem solid #d1d1d1;\n\t\tborder-right: 0.1rem solid #d1d1d1;\n\t}\n\n\t.simple-typeahead .simple-typeahead-list .simple-typeahead-list-item:last-child {\n\t\tborder-bottom: none;\n\t}\n\n\t.simple-typeahead .simple-typeahead-list .simple-typeahead-list-item.simple-typeahead-list-item-active {\n\t\tbackground-color: #e1e1e1;\n\t}\n</style>\n"],"mappings":"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"},"metadata":{},"sourceType":"module","externalDependencies":[]}